<?php 
$paleta_de_colores=[
	'rgba(60, 100, 148, 0.9)',
	'rgba(150, 61, 59, 0.9)',
	'rgba(121, 146, 68, 0.9)',
	'rgba(99, 77, 126, 0.9)',
	'rgba(57, 134, 155, 0.9)',
	'rgba(194, 117, 53, 0.9)',
	'rgba(120, 120, 120, 0.9)',
	'rgba(60, 100, 148, 0.8)',
	'rgba(150, 61, 59, 0.8)',
	'rgba(121, 146, 68, 0.8)',
	'rgba(99, 77, 126, 0.8)',
	'rgba(57, 134, 155, 0.8)',
	'rgba(194, 117, 53, 0.8)',
	'rgba(120, 120, 120, 0.8)',
	'rgba(60, 100, 148, 0.7)',
	'rgba(150, 61, 59, 0.7)',
	'rgba(121, 146, 68, 0.7)',
	'rgba(99, 77, 126, 0.7)',
	'rgba(57, 134, 155, 0.7)',
	'rgba(194, 117, 53, 0.7)',
	'rgba(120, 120, 120, 0.7)',
	'rgba(60, 100, 148, 0.6)',
	'rgba(150, 61, 59, 0.6)',
	'rgba(121, 146, 68, 0.6)',
	'rgba(99, 77, 126, 0.6)',
	'rgba(57, 134, 155, 0.6)',
	'rgba(194, 117, 53, 0.6)',
	'rgba(120, 120, 120, 0.6)',
	'rgba(60, 100, 148, 0.5)',
	'rgba(150, 61, 59, 0.5)',
	'rgba(121, 146, 68, 0.5)',
	'rgba(99, 77, 126, 0.5)',
	'rgba(57, 134, 155, 0.5)',
	'rgba(194, 117, 53, 0.5)',
	'rgba(120, 120, 120, 0.5)',
	'rgba(60, 100, 148, 0.4)',
	'rgba(150, 61, 59, 0.4)',
	'rgba(121, 146, 68, 0.4)',
	'rgba(99, 77, 126, 0.4)',
	'rgba(57, 134, 155, 0.4)',
	'rgba(194, 117, 53, 0.4)',
	'rgba(120, 120, 120, 0.4)',
	'rgba(60, 100, 148, 0.3)',
	'rgba(150, 61, 59, 0.3)',
	'rgba(121, 146, 68, 0.3)',
	'rgba(99, 77, 126, 0.3)',
	'rgba(57, 134, 155, 0.3)',
	'rgba(194, 117, 53, 0.3)',
	'rgba(120, 120, 120, 0.3)',
	'rgba(60, 100, 148, 0.2)',
	'rgba(150, 61, 59, 0.2)',
	'rgba(121, 146, 68, 0.2)',
	'rgba(99, 77, 126, 0.2)',
	'rgba(57, 134, 155, 0.2)',
	'rgba(194, 117, 53, 0.2)',
	'rgba(120, 120, 120, 0.2)',
	'rgba(60, 100, 148, 0.1)',
	'rgba(150, 61, 59, 0.1)',
	'rgba(121, 146, 68, 0.1)',
	'rgba(99, 77, 126, 0.1)',
	'rgba(57, 134, 155, 0.1)',
	'rgba(194, 117, 53, 0.1)',
	'rgba(120, 120, 120, 0.1)',
	'rgba(60, 100, 148, 0.9)',
	'rgba(150, 61, 59, 0.9)',
	'rgba(121, 146, 68, 0.9)',
	'rgba(99, 77, 126, 0.9)',
	'rgba(57, 134, 155, 0.9)',
	'rgba(194, 117, 53, 0.9)',
	'rgba(120, 120, 120, 0.9)',
	'rgba(60, 100, 148, 0.8)',
	'rgba(150, 61, 59, 0.8)',
	'rgba(121, 146, 68, 0.8)',
	'rgba(99, 77, 126, 0.8)',
	'rgba(57, 134, 155, 0.8)',
	'rgba(194, 117, 53, 0.8)',
	'rgba(120, 120, 120, 0.8)',
	'rgba(60, 100, 148, 0.7)',
	'rgba(150, 61, 59, 0.7)',
	'rgba(121, 146, 68, 0.7)',
	'rgba(99, 77, 126, 0.7)',
	'rgba(57, 134, 155, 0.7)',
	'rgba(194, 117, 53, 0.7)',
	'rgba(120, 120, 120, 0.7)',
	'rgba(60, 100, 148, 0.6)',
	'rgba(150, 61, 59, 0.6)',
	'rgba(121, 146, 68, 0.6)',
	'rgba(99, 77, 126, 0.6)',
	'rgba(57, 134, 155, 0.6)',
	'rgba(194, 117, 53, 0.6)',
	'rgba(120, 120, 120, 0.6)',
	'rgba(60, 100, 148, 0.5)',
	'rgba(150, 61, 59, 0.5)',
	'rgba(121, 146, 68, 0.5)',
	'rgba(99, 77, 126, 0.5)',
	'rgba(57, 134, 155, 0.5)',
	'rgba(194, 117, 53, 0.5)',
	'rgba(120, 120, 120, 0.5)',
	'rgba(60, 100, 148, 0.4)',
	'rgba(150, 61, 59, 0.4)',
	'rgba(121, 146, 68, 0.4)',
	'rgba(99, 77, 126, 0.4)',
	'rgba(57, 134, 155, 0.4)',
	'rgba(194, 117, 53, 0.4)',
	'rgba(120, 120, 120, 0.4)',
	'rgba(60, 100, 148, 0.3)',
	'rgba(150, 61, 59, 0.3)',
	'rgba(121, 146, 68, 0.3)',
	'rgba(99, 77, 126, 0.3)',
	'rgba(57, 134, 155, 0.3)',
	'rgba(194, 117, 53, 0.3)',
	'rgba(120, 120, 120, 0.3)',
	'rgba(60, 100, 148, 0.2)',
	'rgba(150, 61, 59, 0.2)',
	'rgba(121, 146, 68, 0.2)',
	'rgba(99, 77, 126, 0.2)',
	'rgba(57, 134, 155, 0.2)',
	'rgba(194, 117, 53, 0.2)',
	'rgba(120, 120, 120, 0.2)',
	'rgba(60, 100, 148, 0.1)',
	'rgba(150, 61, 59, 0.1)',
	'rgba(121, 146, 68, 0.1)',
	'rgba(99, 77, 126, 0.1)',
	'rgba(57, 134, 155, 0.1)',
	'rgba(194, 117, 53, 0.1)',
	'rgba(120, 120, 120, 0.1)',
	'rgba(60, 100, 148, 0.9)',
	'rgba(150, 61, 59, 0.9)',
	'rgba(121, 146, 68, 0.9)',
	'rgba(99, 77, 126, 0.9)',
	'rgba(57, 134, 155, 0.9)',
	'rgba(194, 117, 53, 0.9)',
	'rgba(120, 120, 120, 0.9)',
	'rgba(60, 100, 148, 0.8)',
	'rgba(150, 61, 59, 0.8)',
	'rgba(121, 146, 68, 0.8)',
	'rgba(99, 77, 126, 0.8)',
	'rgba(57, 134, 155, 0.8)',
	'rgba(194, 117, 53, 0.8)',
	'rgba(120, 120, 120, 0.8)',
	'rgba(60, 100, 148, 0.7)',
	'rgba(150, 61, 59, 0.7)',
	'rgba(121, 146, 68, 0.7)',
	'rgba(99, 77, 126, 0.7)',
	'rgba(57, 134, 155, 0.7)',
	'rgba(194, 117, 53, 0.7)',
	'rgba(120, 120, 120, 0.7)',
	'rgba(60, 100, 148, 0.6)',
	'rgba(150, 61, 59, 0.6)',
	'rgba(121, 146, 68, 0.6)',
	'rgba(99, 77, 126, 0.6)',
	'rgba(57, 134, 155, 0.6)',
	'rgba(194, 117, 53, 0.6)',
	'rgba(120, 120, 120, 0.6)',
	'rgba(60, 100, 148, 0.5)',
	'rgba(150, 61, 59, 0.5)',
	'rgba(121, 146, 68, 0.5)',
	'rgba(99, 77, 126, 0.5)',
	'rgba(57, 134, 155, 0.5)',
	'rgba(194, 117, 53, 0.5)',
	'rgba(120, 120, 120, 0.5)',
	'rgba(60, 100, 148, 0.4)',
	'rgba(150, 61, 59, 0.4)',
	'rgba(121, 146, 68, 0.4)',
	'rgba(99, 77, 126, 0.4)',
	'rgba(57, 134, 155, 0.4)',
	'rgba(194, 117, 53, 0.4)',
	'rgba(120, 120, 120, 0.4)',
	'rgba(60, 100, 148, 0.3)',
	'rgba(150, 61, 59, 0.3)',
	'rgba(121, 146, 68, 0.3)',
	'rgba(99, 77, 126, 0.3)',
	'rgba(57, 134, 155, 0.3)',
	'rgba(194, 117, 53, 0.3)',
	'rgba(120, 120, 120, 0.3)',
	'rgba(60, 100, 148, 0.2)',
	'rgba(150, 61, 59, 0.2)',
	'rgba(121, 146, 68, 0.2)',
	'rgba(99, 77, 126, 0.2)',
	'rgba(57, 134, 155, 0.2)',
	'rgba(194, 117, 53, 0.2)',
	'rgba(120, 120, 120, 0.2)',
	'rgba(60, 100, 148, 0.1)',
	'rgba(150, 61, 59, 0.1)',
	'rgba(121, 146, 68, 0.1)',
	'rgba(99, 77, 126, 0.1)',
	'rgba(57, 134, 155, 0.1)',
	'rgba(194, 117, 53, 0.1)',
	'rgba(120, 120, 120, 0.1)',
	'rgba(60, 100, 148, 0.9)',
	'rgba(150, 61, 59, 0.9)',
	'rgba(121, 146, 68, 0.9)',
	'rgba(99, 77, 126, 0.9)',
	'rgba(57, 134, 155, 0.9)',
	'rgba(194, 117, 53, 0.9)',
	'rgba(120, 120, 120, 0.9)',
	'rgba(60, 100, 148, 0.8)',
	'rgba(150, 61, 59, 0.8)',
	'rgba(121, 146, 68, 0.8)',
	'rgba(99, 77, 126, 0.8)',
	'rgba(57, 134, 155, 0.8)',
	'rgba(194, 117, 53, 0.8)',
	'rgba(120, 120, 120, 0.8)',
	'rgba(60, 100, 148, 0.7)',
	'rgba(150, 61, 59, 0.7)',
	'rgba(121, 146, 68, 0.7)',
	'rgba(99, 77, 126, 0.7)',
	'rgba(57, 134, 155, 0.7)',
	'rgba(194, 117, 53, 0.7)',
	'rgba(120, 120, 120, 0.7)',
	'rgba(60, 100, 148, 0.6)',
	'rgba(150, 61, 59, 0.6)',
	'rgba(121, 146, 68, 0.6)',
	'rgba(99, 77, 126, 0.6)',
	'rgba(57, 134, 155, 0.6)',
	'rgba(194, 117, 53, 0.6)',
	'rgba(120, 120, 120, 0.6)',
	'rgba(60, 100, 148, 0.5)',
	'rgba(150, 61, 59, 0.5)',
	'rgba(121, 146, 68, 0.5)',
	'rgba(99, 77, 126, 0.5)',
	'rgba(57, 134, 155, 0.5)',
	'rgba(194, 117, 53, 0.5)',
	'rgba(120, 120, 120, 0.5)',
	'rgba(60, 100, 148, 0.4)',
	'rgba(150, 61, 59, 0.4)',
	'rgba(121, 146, 68, 0.4)',
	'rgba(99, 77, 126, 0.4)',
	'rgba(57, 134, 155, 0.4)',
	'rgba(194, 117, 53, 0.4)',
	'rgba(120, 120, 120, 0.4)',
	'rgba(60, 100, 148, 0.3)',
	'rgba(150, 61, 59, 0.3)',
	'rgba(121, 146, 68, 0.3)',
	'rgba(99, 77, 126, 0.3)',
	'rgba(57, 134, 155, 0.3)',
	'rgba(194, 117, 53, 0.3)',
	'rgba(120, 120, 120, 0.3)',
	'rgba(60, 100, 148, 0.2)',
	'rgba(150, 61, 59, 0.2)',
	'rgba(121, 146, 68, 0.2)',
	'rgba(99, 77, 126, 0.2)',
	'rgba(57, 134, 155, 0.2)',
	'rgba(194, 117, 53, 0.2)',
	'rgba(120, 120, 120, 0.2)',
	'rgba(60, 100, 148, 0.1)',
	'rgba(150, 61, 59, 0.1)',
	'rgba(121, 146, 68, 0.1)',
	'rgba(99, 77, 126, 0.1)',
	'rgba(57, 134, 155, 0.1)',
	'rgba(194, 117, 53, 0.1)',
	'rgba(120, 120, 120, 0.1)'
];
if(isset($_POST['pais'])){
	$pais=$_POST['pais'];
	require_once ("M_todos.php");
	//OBTENIENDO DATOS PARA GRAFICAS DE BARRAS
	if($pais=="WW"){
		$url_prueba = "https://covid19-api.org/api/timeline";
		$curl_2=curl_init();
		curl_setopt_array($curl_2, array(
			CURLOPT_URL => $url_prueba,
			CURLOPT_RETURNTRANSFER => true,
			CURLOPT_ENCODING => "",
			CURLOPT_MAXREDIRS => 10,
			CURLOPT_TIMEOUT => 0,
			CURLOPT_FOLLOWLOCATION => true,
			CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			CURLOPT_CUSTOMREQUEST => "GET",
		));
		$resp_2=curl_exec($curl_2);
		curl_close($curl_2);
		$resp_decode_2=(array) json_decode($resp_2, true);
		//DEPURANDO DATOS PARA LAS GRÁFICAS
		$datos[0]['FECHA']="";
		$datos[0]['TOTAL_CASOS']=0;
		$datos[0]['TOTAL_MUERTES']=0;
		$datos[0]['TOTAL_RECUPERADOS']=0;
		$datos[0]['TOTAL_ACTIVOS']=0;
		$datos[0]['PUNTUAL_CASOS']=0;
		$datos[0]['PUNTUAL_MUERTES']=0;
		$datos[0]['PUNTUAL_RECUPERADOS']=0;
		$e=count($resp_decode_2)-1;
		$i=0;
		while(isset($resp_decode_2[$e]["last_update"])){
			$fecha_ii=explode("T", $resp_decode_2[$e]["last_update"]);
			$datos[$i]['FECHA']=$fecha_ii[0];
			if($i==0){
				$datos[$i]['TOTAL_CASOS']=$resp_decode_2[$e]["total_cases"];
				$datos[$i]['TOTAL_MUERTES']=$resp_decode_2[$e]["total_deaths"];
				$datos[$i]['TOTAL_RECUPERADOS']=$resp_decode_2[$e]["total_recovered"];
			}else{
				if($resp_decode_2[$e]["total_cases"]<$datos[$i-1]['TOTAL_CASOS']){
					$datos[$i]['TOTAL_CASOS']=$datos[$i-1]['TOTAL_CASOS'];
				}else{
					$datos[$i]['TOTAL_CASOS']=$resp_decode_2[$e]["total_cases"];
				}
				if($resp_decode_2[$e]["total_deaths"]<$datos[$i-1]['TOTAL_MUERTES']){
					$datos[$i]['TOTAL_MUERTES']=$datos[$i-1]['TOTAL_MUERTES'];
				}else{
					$datos[$i]['TOTAL_MUERTES']=$resp_decode_2[$e]["total_deaths"];
				}
				if($resp_decode_2[$e]["total_recovered"]<$datos[$i-1]['TOTAL_RECUPERADOS']){
					$datos[$i]['TOTAL_RECUPERADOS']=$datos[$i-1]['TOTAL_RECUPERADOS'];
				}else{
					$datos[$i]['TOTAL_RECUPERADOS']=$resp_decode_2[$e]["total_recovered"];
				}
			}
			if($datos[$i]['TOTAL_CASOS']-$datos[$i]['TOTAL_MUERTES']-$datos[$i]['TOTAL_RECUPERADOS']<0){
				$datos[$i]['TOTAL_RECUPERADOS']=$datos[$i]['TOTAL_CASOS']-$datos[$i]['TOTAL_MUERTES'];
			}
			$datos[$i]['TOTAL_ACTIVOS']=$datos[$i]['TOTAL_CASOS']-$datos[$i]['TOTAL_MUERTES']-$datos[$i]['TOTAL_RECUPERADOS'];
			if($i==0){
				$datos[$i]['PUNTUAL_CASOS']=$datos[$i]['TOTAL_CASOS'];
				$datos[$i]['PUNTUAL_MUERTES']=$datos[$i]['TOTAL_MUERTES'];
				$datos[$i]['PUNTUAL_RECUPERADOS']=$datos[$i]['TOTAL_RECUPERADOS'];
			}else{
				$datos[$i]['PUNTUAL_CASOS']=$datos[$i]['TOTAL_CASOS']-$datos[$i-1]['TOTAL_CASOS'];
				$datos[$i]['PUNTUAL_MUERTES']=$datos[$i]['TOTAL_MUERTES']-$datos[$i-1]['TOTAL_MUERTES'];
				$datos[$i]['PUNTUAL_RECUPERADOS']=$datos[$i]['TOTAL_RECUPERADOS']-$datos[$i-1]['TOTAL_RECUPERADOS'];
			}
			$i++;
			$e--;
		}
	}else{
		$url_prueba = "https://covid19-api.org/api/timeline/". $pais;
		$curl_2=curl_init();
		curl_setopt_array($curl_2, array(
			CURLOPT_URL => $url_prueba,
			CURLOPT_RETURNTRANSFER => true,
			CURLOPT_ENCODING => "",
			CURLOPT_MAXREDIRS => 10,
			CURLOPT_TIMEOUT => 0,
			CURLOPT_FOLLOWLOCATION => true,
			CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			CURLOPT_CUSTOMREQUEST => "GET",
		));
		$resp_2=curl_exec($curl_2);
		curl_close($curl_2);
		$resp_decode_2=(array) json_decode($resp_2, true);
		//DEPURANDO DATOS PARA LAS GRÁFICAS
		$datos[0]['FECHA']="";
		$datos[0]['TOTAL_CASOS']=0;
		$datos[0]['TOTAL_MUERTES']=0;
		$datos[0]['TOTAL_RECUPERADOS']=0;
		$datos[0]['TOTAL_ACTIVOS']=0;
		$datos[0]['PUNTUAL_CASOS']=0;
		$datos[0]['PUNTUAL_MUERTES']=0;
		$datos[0]['PUNTUAL_RECUPERADOS']=0;
		$e=count($resp_decode_2)-1;
		$i=0;
		while(isset($resp_decode_2[$e]["last_update"])){
			$fecha_ii=explode("T", $resp_decode_2[$e]["last_update"]);
			$datos[$i]['FECHA']=$fecha_ii[0];
			if($i==0){
				$datos[$i]['TOTAL_CASOS']=$resp_decode_2[$e]["cases"];
				$datos[$i]['TOTAL_MUERTES']=$resp_decode_2[$e]["deaths"];
				$datos[$i]['TOTAL_RECUPERADOS']=$resp_decode_2[$e]["recovered"];
			}else{
				if($resp_decode_2[$e]["cases"]<$datos[$i-1]['TOTAL_CASOS']){
					$datos[$i]['TOTAL_CASOS']=$datos[$i-1]['TOTAL_CASOS'];
				}else{
					$datos[$i]['TOTAL_CASOS']=$resp_decode_2[$e]["cases"];
				}
				if($resp_decode_2[$e]["deaths"]<$datos[$i-1]['TOTAL_MUERTES']){
					$datos[$i]['TOTAL_MUERTES']=$datos[$i-1]['TOTAL_MUERTES'];
				}else{
					$datos[$i]['TOTAL_MUERTES']=$resp_decode_2[$e]["deaths"];
				}
				if($resp_decode_2[$e]["recovered"]<$datos[$i-1]['TOTAL_RECUPERADOS']){
					$datos[$i]['TOTAL_RECUPERADOS']=$datos[$i-1]['TOTAL_RECUPERADOS'];
				}else{
					$datos[$i]['TOTAL_RECUPERADOS']=$resp_decode_2[$e]["recovered"];
				}
			}
			if($datos[$i]['TOTAL_CASOS']-$datos[$i]['TOTAL_MUERTES']-$datos[$i]['TOTAL_RECUPERADOS']<0){
				$datos[$i]['TOTAL_RECUPERADOS']=$datos[$i]['TOTAL_CASOS']-$datos[$i]['TOTAL_MUERTES'];
			}
			$datos[$i]['TOTAL_ACTIVOS']=$datos[$i]['TOTAL_CASOS']-$datos[$i]['TOTAL_MUERTES']-$datos[$i]['TOTAL_RECUPERADOS'];
			if($i==0){
				$datos[$i]['PUNTUAL_CASOS']=$datos[$i]['TOTAL_CASOS'];
				$datos[$i]['PUNTUAL_MUERTES']=$datos[$i]['TOTAL_MUERTES'];
				$datos[$i]['PUNTUAL_RECUPERADOS']=$datos[$i]['TOTAL_RECUPERADOS'];
			}else{
				$datos[$i]['PUNTUAL_CASOS']=$datos[$i]['TOTAL_CASOS']-$datos[$i-1]['TOTAL_CASOS'];
				$datos[$i]['PUNTUAL_MUERTES']=$datos[$i]['TOTAL_MUERTES']-$datos[$i-1]['TOTAL_MUERTES'];
				$datos[$i]['PUNTUAL_RECUPERADOS']=$datos[$i]['TOTAL_RECUPERADOS']-$datos[$i-1]['TOTAL_RECUPERADOS'];
				$datos[$i]['PUNTUAL_RECUPERADOS']=$datos[$i]['TOTAL_RECUPERADOS']-$datos[$i-1]['TOTAL_RECUPERADOS'];
			}
			$i++;
			$e--;
		}
	}
	
	$largo_datos=$i-1;
	echo "
		<div class='row'>
			<div class='col-sm-6 pb-2'>
				<h6 class='text-center'><br>Nuevos Casos: <b>" . number_format($datos[$largo_datos]['PUNTUAL_CASOS'], 0,'.',',') . "</b><br>Nuevas Muertes: <b>" .  number_format($datos[$largo_datos]['PUNTUAL_MUERTES'], 0,'.',',') . "</b><br>Nuevos Recuperados: <b>" .  number_format($datos[$largo_datos]['PUNTUAL_RECUPERADOS'], 0,'.',',') . "</b>
				<br>
				</h6>
				<canvas id='graf_puntual' class='border border-secondary'></canvas>
			</div>
			<div class='col-sm-6 pb-2'>
				<h6 class='text-center'>Total de Casos: <b>" . number_format($datos[$largo_datos]['TOTAL_CASOS'], 0,'.',',') . "</b><br>Total de Muertes: <b>" . number_format($datos[$largo_datos]['TOTAL_MUERTES'], 0,'.',',') . "</b><br>Total Recuperados: <b>" . number_format($datos[$largo_datos]['TOTAL_RECUPERADOS'], 0,'.',',') . "</b><br>Total Activos: <b>" . number_format($datos[$largo_datos]['TOTAL_ACTIVOS'], 0,'.',',') . "</b></h6>
				<canvas id='graf_acum' class='border border-secondary'></canvas>
			</div>
		</div>
	";
	echo "
		<script>
			var ctx = document.getElementById('graf_puntual').getContext('2d');
			var chart = new Chart(ctx, {
				type: 'bar',
				data: {
					labels: [";
	$i=0;
	while(isset($datos[$i]['FECHA'])){
		echo "'" . $datos[$i]['FECHA'] . "'";
		if(isset($datos[$i+1]['FECHA'])){
			echo ",";
		}
		$i++;
	}
	echo "          ],
					datasets: [{
						label: 'Casos',
						borderColor: 'rgb(60, 100, 148, 1)',
						backgroundColor: 'rgb(60, 100, 148, 0.8)',
						data: [
	";
	$i=0;
	while(isset($datos[$i]['FECHA'])){
		echo "'" . $datos[$i]['PUNTUAL_CASOS'] . "'";
		if(isset($datos[$i+1]['FECHA'])){
			echo ",";
		}
		$i++;
	}
	echo "
						]
					},
					{
						label: 'Muertes',
						borderColor: 'rgb(150, 61, 59, 1)',
						backgroundColor: 'rgb(150, 61, 59, 0.8)',
						data: [
	";
	$i=0;
	while(isset($datos[$i]['FECHA'])){
		echo "'" . $datos[$i]['PUNTUAL_MUERTES'] . "'";
		if(isset($datos[$i+1]['FECHA'])){
			echo ",";
		}
		$i++;
	}
	echo "
						]
					},
					{
						label: 'Recuperados',
						borderColor: 'rgb(39, 113, 3, 1)',
						backgroundColor: 'rgb(39, 113, 3, 0.8)',
						data: [
	";
	$i=0;
	while(isset($datos[$i]['FECHA'])){
		echo "'" . $datos[$i]['PUNTUAL_RECUPERADOS'] . "'";
		if(isset($datos[$i+1]['FECHA'])){
			echo ",";
		}
		$i++;
	}
	echo "
						]
					}]
				},
				options: {
					responsive: true,
					title: {
						display: true,
						text: 'Datos Puntuales'
					},
					tooltips: {
						mode: 'index',
						intersect: false,
					},
					hover: {
						mode: 'nearest',
						intersect: true
					},
					scales: {
						xAxes: [{
							display: false,
							scaleLabel: {
								display: true,
								labelString: 'dia'
							}
						}],
						yAxes: [{
							display: false,
							scaleLabel: {
								display: true,
								labelString: ''
							}
						}]
					}
				}							
			});			
		</script>
	";
	echo "
		<script>
			var ctx = document.getElementById('graf_acum').getContext('2d');
			var chart = new Chart(ctx, {
				type: 'bar',
				data: {
					labels: [";
	$i=0;
	while(isset($datos[$i]['FECHA'])){
		echo "'" . $datos[$i]['FECHA'] . "'";
		if(isset($datos[$i+1]['FECHA'])){
			echo ",";
		}
		$i++;
	}
	echo "          ],
					datasets: [{
						label: 'Casos',
						borderColor: 'rgb(60, 100, 148, 1)',
						backgroundColor: 'rgb(60, 100, 148, 0.8)',
						data: [
	";
	$i=0;
	while(isset($datos[$i]['FECHA'])){
		echo "'" . $datos[$i]['TOTAL_CASOS'] . "'";
		if(isset($datos[$i+1]['FECHA'])){
			echo ",";
		}
		$i++;
	}
	echo "
						]
					},
					{
						label: 'Muertes',
						borderColor: 'rgb(150, 61, 59, 1)',
						backgroundColor: 'rgb(150, 61, 59, 0.8)',
						data: [
	";
	$i=0;
	while(isset($datos[$i]['FECHA'])){
		echo "'" . $datos[$i]['TOTAL_MUERTES'] . "'";
		if(isset($datos[$i+1]['FECHA'])){
			echo ",";
		}
		$i++;
	}
	echo "
						]
					},
					{
						label: 'Recuperados',
						borderColor: 'rgb(39, 113, 3, 1)',
						backgroundColor: 'rgb(39, 113, 3, 0.8)',
						data: [
	";
	$i=0;
	while(isset($datos[$i]['FECHA'])){
		echo "'" . $datos[$i]['TOTAL_RECUPERADOS'] . "'";
		if(isset($datos[$i+1]['FECHA'])){
			echo ",";
		}
		$i++;
	}
	echo "
						]
					},
					{
						label: 'Activos',
						borderColor: 'rgb(255, 134, 35, 1)',
						backgroundColor: 'rgb(255, 134, 35, 0.8)',
						data: [
	";
	$i=0;
	while(isset($datos[$i]['FECHA'])){
		echo "'" . $datos[$i]['TOTAL_ACTIVOS'] . "'";
		if(isset($datos[$i+1]['FECHA'])){
			echo ",";
		}
		$i++;
	}
	echo "
						]
					}]
				},
				options: {
					responsive: true,
					title: {
						display: true,
						text: 'Datos Acumulados'
					},
					tooltips: {
						mode: 'index',
						intersect: false,
					},
					hover: {
						mode: 'nearest',
						intersect: true
					},
					scales: {
						xAxes: [{
							display: false,
							scaleLabel: {
								display: true,
								labelString: 'dia'
							}
						}],
						yAxes: [{
							display: false,
							scaleLabel: {
								display: true,
								labelString: ''
							}
						}]
					}
				}							
			});			
		</script>
	";
	if($pais<>"WW"){
		$url_prueba3 = "https://covid19-api.org/api/prediction/" . $pais;
		$curl_3=curl_init();
		curl_setopt_array($curl_3, array(
			CURLOPT_URL => $url_prueba3,
			CURLOPT_RETURNTRANSFER => true,
			CURLOPT_ENCODING => "",
			CURLOPT_MAXREDIRS => 10,
			CURLOPT_TIMEOUT => 0,
			CURLOPT_FOLLOWLOCATION => true,
			CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			CURLOPT_CUSTOMREQUEST => "GET",
		));
		$resp_3=curl_exec($curl_3);
		curl_close($curl_3);
		$resp_decode_3=(array) json_decode($resp_3, true);
		echo "<br><h3 class='text-danger text-center'><b>Predicción:</b></h3><h6 class='text-danger text-center small'>en 15 dias habrán <b>" .  number_format($resp_decode_3[count($resp_decode_3)-1]["cases"], 0,'.',',') . " Casos Acumulados</b></h6><hr>";
	}
	
	if($pais=="VE"){
		$url_prueba = "https://covid19.patria.org.ve/api/v1/summary";
		$curl_2=curl_init();
		curl_setopt_array($curl_2, array(
			CURLOPT_URL => $url_prueba,
			CURLOPT_RETURNTRANSFER => true,
			CURLOPT_ENCODING => "",
			CURLOPT_MAXREDIRS => 10,
			CURLOPT_TIMEOUT => 0,
			CURLOPT_FOLLOWLOCATION => true,
			CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			CURLOPT_CUSTOMREQUEST => "GET",
		));
		$resp_2=curl_exec($curl_2);
		curl_close($curl_2);
		$resp_decode_2=(array) json_decode($resp_2, true);
		echo "
			<br>
			<div class='container-fluid px-0'>
				<div class='table-responsive d-block d-xl-none px-0 mx-0 bg-light'>
					<h3 class='text-center'><b>Casos por Género</b></h3>
					<table class='table table-bordered table-hover table-striped TablaDinamica px-0 mx-0'>
						<thead>
							<tr class='text-center text-warning bg-dark'>
								<th class='align-middle w-50'><b>Hombres</b></th>
								<th class='align-middle w-50'><b>Mujeres</b></th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td class='text-center py-0 px-1 w-50'>" . number_format($resp_decode_2['Confirmed']['ByGender']['male'], 0,'.',',') . "</td>
								<td class='text-center py-0 px-1 w-50'>" . number_format($resp_decode_2['Confirmed']['ByGender']['female'], 0,'.',',') . "</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		";
		echo "
			<br>
			<div class='container-fluid px-0'>
				<div class='table-responsive d-block d-xl-none px-0 mx-0 bg-light'>
					<h3 class='text-center'><b>Casos por Edad</b></h3>
					<table class='table table-bordered table-hover table-striped TablaDinamicaOrderDesc2 px-0 mx-0'>
						<thead>
							<tr class='text-center text-warning bg-dark'>
								<th class='align-middle w-50'><b>Edad</b></th>
								<th class='align-middle w-50'><b>Casos</b></th>
							</tr>
						</thead>
						<tbody>
		";
		foreach($resp_decode_2['Confirmed']['ByAgeRange'] as $clave => $valor){
			echo "
							<tr>
								<td class='text-left py-0 px-1 w-50'>" . $clave . "</td>
								<td class='text-right py-0 px-1 w-50'>" . number_format($valor, 0,'.',',') . "</td>
							</tr>
			";
		}
		echo "
						</tbody>
					</table>
				</div>
			</div>
		";
		echo "
			<br>
			<div class='container-fluid px-0'>
				<div class='table-responsive d-block d-xl-none px-0 mx-0 bg-light'>
					<h3 class='text-center'><b>Casos por Estado</b></h3>
					<table class='table table-bordered table-hover table-striped TablaDinamicaOrderDesc2 px-0 mx-0'>
						<thead>
							<tr class='text-center text-warning bg-dark'>
								<th class='align-middle w-50'><b>Estado</b></th>
								<th class='align-middle w-50'><b>Casos</b></th>
							</tr>
						</thead>
						<tbody>
		";
		foreach($resp_decode_2['Confirmed']['ByState'] as $clave => $valor){
			echo "
							<tr>
								<td class='text-left py-0 px-1 w-50'>" . $clave . "</td>
								<td class='text-right py-0 px-1 w-50'>" . number_format($valor, 0,'.',',') . "</td>
							</tr>
			";
		}
		echo "
						</tbody>
					</table>
				</div>
			</div>
		";
	}
}

?>
	<!-- ENLACES PARA LLAMAR AL PAGINADO Y BUSCADOR DE LA DATATABLE -->
	<script src="js/jquery.dataTables.js"></script>
	<script src="js/dataTables.bootstrap4.js"></script>
	<script>
		$(document).ready(function() {
			$('.TablaDinamicaOrderDesc2').DataTable({
				order: [[ 1, 'desc' ]]
			});
		});
	</script>	
